---
title: "r2dii.plot X"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This article shows the "X" API. It assumes you already read the [article
comparing the "X" and "Y"
APIs](https://2degreesinvesting.github.io/r2dii.plot/articles/articles/r2dii-plot-X-versus-Y.html).

```{r setup}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2, warn.conflicts = FALSE)
library(r2dii.plot)
```

### Timeline

Use `plot_timelineX()` with `sda`-like data. You'll need to pick the
specific rows you want to plot. For details see the documented "Requirements" of
the argument `data`, or try intuitively and let the error messages guide you.

```{r error = TRUE}
plot_timelineX(sda)
```

The error message suggests you must first pick only one value of `sector`, for
example "cement".

```{r}
sda %>% 
  filter(sector == "cement") %>% 
  plot_timelineX()
```

Great! You can now polish your plot. Your options are limitless but these are
some typical things you may do:

* Pick a narrower time range.
* Recode the legend.
* Extrapolate the timeline.
* Add a title. 

```{r}
to_title <- function(x) gsub("_", " ", tools::toTitleCase(x))

sda %>% 
  filter(sector == "cement", year >= 2020) %>% 
  mutate(emission_factor_metric = to_title(emission_factor_metric)) %>% 
  plot_timelineX(extrapolate = TRUE) + labs(title = "Timeline plot")
```

You can further customize your plot by adding a custom manual scale using 
`ggplot` function `scale_colour_manual()` with custom legend labels. 

```{r}
sda %>% 
  filter(sector == "cement") %>% 
  plot_timelineX(extrapolate = TRUE) +
  scale_color_manual(
    values = c("#4a5e54", "#a63d57", "#78c4d6", "#f2e06e"),
    labels = c("Proj.", "Corp. Economy", "Target (demo)", "Adj. Scenario (demo)"))
```

### Techmix

Use `plot_techmixX()` with `market_share`-like data. Again, learn which rows to
pick by reading the documented "Requirements" of the argument `data`, or by trial and error.

```{r error = TRUE}
unique(market_share$metric)
chosen_metrics <- c("projected", "corporate_economy", "target_sds")

market_share %>%
  filter(
    metric %in% chosen_metrics,
    sector == "power",
    region == "global"
  ) %>% 
  plot_techmixX() + labs(title = "Techmix plot")
```

### Trajectory

Use `plot_trajectoryX()` with `market_share`-like data. Again, learn which rows
to pick by reading the documented "Requirements" of the argument `data`, or by
trial and error.

```{r}
data <- market_share %>% 
  filter(
    sector == "power", 
    region == "global", 
    technology == "renewablescap",
    year <= 2025
  )

plot_trajectoryX(data) + labs(title = "Trajectory plot")
```

Use `main_line` argument to indicate which trajectory line should be most 
visually salient (solid black line).

```{r}
plot_trajectoryX(data, main_line = "projected")
```

Use `normalize = FALSE` if you prefer not to normalize to the start year.

```{r}
plot_trajectoryX(data, main_line = "projected", normalize = FALSE)
```

If you haven't done so already, please see the [article about the "Y"
API](https://2degreesinvesting.github.io/r2dii.plot/articles/articles/r2dii-plot-Y.html).
