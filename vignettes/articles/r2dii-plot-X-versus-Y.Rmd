---
title: "r2dii.plot X versus Y"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The goal of r2dii.plot is to help you plot 2DII data in an informative,
beautiful, and easy way.

## Installation

You can install the development version of r2dii.plot from
[GitHub](https://github.com/2DegreesInvesting/r2dii.plot) with:

```r
# install.packages("devtools")
devtools::install_github("2DegreesInvesting/r2dii.plot")
```

## Example

The r2dii.plot package is designed to work smoothly with other "r2dii" packages
-- [r2dii.data](https://2degreesinvesting.github.io/r2dii.data/),
[r2dii.match](https://2degreesinvesting.github.io/r2dii.match/), and
[r2dii.analysis](https://2degreesinvesting.github.io/r2dii.analysis/). It also
plays well with the popular packages [dplyr](https://www.tidyverse.org/) and
[ggplot2](https://ggplot2.tidyverse.org/), which help you customize your plots.

```{r setup}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2, warn.conflicts = FALSE)
library(r2dii.plot)
```

Your data typically comes from the output of two functions in the r2dii.analysis
package:
[`target_sda()`](https://2degreesinvesting.github.io/r2dii.analysis/reference/target_sda.html)
and
[`target_market_share()`](https://2degreesinvesting.github.io/r2dii.analysis/reference/target_market_share.html).
Here you'll use two example datasets that come with r2dii.plot.

```{r}
sda

market_share
```

r2dii.plot currently supports three kinds of plots: `plot_timeline*()`,
`plot_techmix*()`, and `plot_trajectory*()`. Each plot has specific requirements
about the main input -- passed to the first argument `data`. To meet those
requirements we currently provide two experimental sets of functions
([API](https://en.wikipedia.org/wiki/API)s) -- "X" and "Y". Both APIs can help
you get the same basic plots, which you can further customization with ggplot2.
Their difference difference is not in what you can do but in how you can do it:

* With the "X" API you meet the `data` requirements mainly with
`dplyr::filter()`, and with "internal magic" based on the known structure of
r2dii data. This API should be best for users who already use dplyr or want to
learn it.

* With the "Y" API you could meet the `data` requirements with dplyr but you can
also use dedicated "preparation" functions (`prep_*Y()`),, and with explicit
arguments to both the preparation and and plotting functions. This API should
best for users who do not use dplyr or care about it.

Users and developers may have different preferences. The tables below compare
the X and Y APIs across a number of criteria relevant to them.

```{r echo=FALSE}
users <- tibble::tribble(
  ~Criteria, ~`Thin API "X"`, ~`Thin API, "Y"`,
  "Required knowledge of dplyr and ggplot2", "More", "Less",
  "Customization possible", "Limitless with dplyr and ggplot2", "Limitless with dplyr, ggplot2, and r2dii.plot",
  "Integration with other R workflows", "More", "Less",
)
caption <- "The X and Y APIs compared from a user's perspective."
knitr::kable(users, caption = caption)

devs <- tibble::tribble(
  ~Criteria, ~`Thin API "X"`, ~`Thin API, "Y"`,
  "Maintenance burden", "Less", "More",
  "Easy to extend", "More", "Less",
  
)
caption <- "The X and Y APIs compared from a developer's perspective."
knitr::kable(devs, caption = caption)
```

To make the comparison concrete consider this small example. Notice the
resulting plot is the same but the toolkit is different.

* "X" API

```{r}
data <- market_share

prep <- filter(
  data,
  sector == "power",
  technology == "renewablescap",
  region == "global",
  scenario_source == "demo_2020",
  year <= 2025
)

plot_trajectoryX(prep) + 
  labs (title = "Trajectory plot with the thin 'X' API")
```

* "Y" API

```{r}
data <- market_share

prep <- prep_trajectoryY(
  data,
  sector_filter = "power",
  technology_filter = "renewablescap",
  region_filter = "global",
  scenario_source_filter = "demo_2020",
  value = "production"
)

scenario_specs <- dplyr::tibble(
  scenario = c("sds", "sps", "cps"),
  label = c("SDS", "STEPS", "CPS")
)

main_line_metric <- dplyr::tibble(metric = "projected", label = "Portfolio")

additional_line_metrics <- dplyr::tibble(
  metric = "corporate_economy",
  label = "Corporate Economy"
)

plot_trajectoryY(
  prep,
  scenario_specs_good_to_bad = scenario_specs,
  main_line_metric = main_line_metric,
  additional_line_metrics = additional_line_metrics
) + 
  labs (title = "Trajectory plot with the thick 'Y' API")
```

For full examples see the dedicated articles [r2dii.plot
X](https://2degreesinvesting.github.io/r2dii.plot/articles/articles/r2dii-plot-X.html)
and [r2dii.plot
Y](https://2degreesinvesting.github.io/r2dii.plot/articles/articles/r2dii-plot-Y.html).
