---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  fig.align = "left",
  out.width = "100%"
)
```

# r2dii.plot <a href='https://github.com/2DegreesInvesting/r2dii.plot'><img src='https://imgur.com/A5ASZPE.png' align='right' height='43' /></a>

<!-- badges: start -->
[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html)
[![Codecov test coverage](https://codecov.io/gh/2DegreesInvesting/r2dii.plot/branch/master/graph/badge.svg)](https://codecov.io/gh/2DegreesInvesting/r2dii.plot?branch=master)
[![R-CMD-check](https://github.com/2DegreesInvesting/r2dii.plot/workflows/R-CMD-check/badge.svg)](https://github.com/2DegreesInvesting/r2dii.plot/actions)
<!-- badges: end -->

The goal of r2dii.plot is to help you plot 2DII data in an informative,
beautiful, and easy way.

## Installation

You can install the development version of r2dii.plot from
[GitHub](https://github.com/2DegreesInvesting/r2dii.plot) with:

```r
# install.packages("devtools")
devtools::install_github("2DegreesInvesting/r2dii.plot")
```

## Example

The r2dii.plot package is designed to work smoothly with other "r2dii" packages
-- [r2dii.data](https://2degreesinvesting.github.io/r2dii.data/),
[r2dii.match](https://2degreesinvesting.github.io/r2dii.match/), and
[r2dii.analysis](https://2degreesinvesting.github.io/r2dii.analysis/). It also
plays well with the [ggplot2](https://ggplot2.tidyverse.org/) package, which
helps you customize your plots.

```{r setup}
library(ggplot2, warn.conflicts = FALSE)
library(r2dii.plot)
```

Your data typically comes from the output of two functions in the r2dii.analysis
package:
[`target_sda()`](https://2degreesinvesting.github.io/r2dii.analysis/reference/target_sda.html)
and
[`target_market_share()`](https://2degreesinvesting.github.io/r2dii.analysis/reference/target_market_share.html).
Here you'll use two example datasets that come with r2dii.plot.

```{r}
sda

market_share
```

r2dii.plot supports three kinds of plots -- timeline, techmix, and trajectory.
For each kind, you'll need to subset the specific rows you want to plot. For
details see the documented "Requirements" of the argument `data` of each
`plot_*()` function (e.g. see `?plot_timeline`). If you forget to meet the
`data` requirements the error message should guide you.

### Timeline

Use `plot_emission_intensity()` with `sda`-like data. Try an intuitive, naive call.

```{r error = TRUE}
plot_emission_intensity(sda)
```

The error message guides you to subset a single value of `sector`. Try "cement".

```{r}
data <- subset(sda, sector == "cement")

plot_emission_intensity(data)
```

Great! You can now polish your plot. Your options are limitless but these are
some typical things you may do:

* Extrapolate the timeline.
* Add a title. 
* Customize the legend labels with `ggplot2::scale_colour_manual()`.

```{r}
data <- subset(sda, sector == "cement")

plot_emission_intensity(data, extrapolate = TRUE) + 
  labs(title = "Timeline plot") +
  scale_color_manual(
    values = c("#4a5e54", "#a63d57", "#78c4d6", "#f2e06e"),
    labels = c("Proj.", "Corp. Economy", "Target (demo)", "Adj. Scenario (demo)")
  )
```

### Techmix

Use `plot_techmix()` with `market_share`-like data.

```{r error = TRUE}
data <- subset(
  market_share, 
  metric %in% c("projected", "corporate_economy", "target_sds") & 
    sector == "power" &
    region == "global"
)

plot_techmix(data) + 
  labs(title = "Techmix plot")
```

These are some tweaks you may consider:

* Subset a custom time range (instead of the default, full range in the data).
* Set custom colours and legend labels with `ggplot2::scale_color_manual()`.

```{r error = TRUE}
data <- subset(
  market_share,
  metric %in% c("projected", "corporate_economy", "target_sds") &
    sector == "power" &
    region == "global" &
    year >= 2020 & year <= 2025  # custom time range
  )

plot_techmix(data) + 
  scale_fill_manual(
    values = c("black", "brown", "grey", "blue", "green4"),
    labels = paste(c("Coal", "Oil", "Gas", "Hydro", "Renewables"), "Cap.")
  )
```

### Trajectory

Use `plot_trajectory()` with `market_share`-like data.

```{r}
data <- subset(
  market_share,
  sector == "power" &
    region == "global" &
    technology == "renewablescap" &
    year <= 2025
  )

plot_trajectory(data) + 
  labs(title = "Trajectory plot")
```
